# GPT-4o与Gemini-1.5-flash在鬼探头与Cut-in检测任务上的性能比较

## 实验概述

本实验对比了GPT-4o和Gemini-1.5-flash两种大语言模型在视频中鬼探头(Ghost Probing)和加塞(Cut-in)行为检测任务上的性能。测试数据集包含来自DADA-2000数据集的80个视频(images_10_001到images_10_080)，每个视频都有人工标注的ground truth标签。

## 总体性能比较

| 指标 | GPT-4o | Gemini-1.5-flash | 差异(GPT-4o - Gemini) |
|------|--------|-------------------|----------------------|
| 视频级别准确率 | 58.75% | 52.50% | +6.25% |
| 事件级别准确率 | 29.55% | 6.82% | +22.73% |
| 精确度 | 16.05% | 9.38% | +6.67% |
| 召回率 | 29.55% | 6.82% | +22.73% |
| F1分数 | 20.80% | 7.89% | +12.91% |
| 总事件数 | 44 | 44 | 0 |
| 匹配事件数 | 13 | 3 | +10 |
| 假阳性数 | 68 | 29 | +39 |
| 假阴性数 | 31 | 41 | -10 |

## 按事件类型的性能

### 鬼探头(Ghost Probing)

| 指标 | GPT-4o | Gemini-1.5-flash | 差异(GPT-4o - Gemini) |
|------|--------|-------------------|----------------------|
| 总事件数 | 22 | 22 | 0 |
| 匹配事件数 | 3 | 3 | 0 |
| 假阳性数 | 23 | 23 | 0 |
| 假阴性数 | 19 | 19 | 0 |
| 精确度 | 11.54% | 11.54% | 0% |
| 召回率 | 13.64% | 13.64% | 0% |
| F1分数 | 12.50% | 12.50% | 0% |

### 加塞(Cut-in)

| 指标 | GPT-4o | Gemini-1.5-flash | 差异(GPT-4o - Gemini) |
|------|--------|-------------------|----------------------|
| 总事件数 | 22 | 22 | 0 |
| 匹配事件数 | 10 | 0 | +10 |
| 假阳性数 | 45 | 6 | +39 |
| 假阴性数 | 12 | 22 | -10 |
| 精确度 | 18.18% | 0.00% | +18.18% |
| 召回率 | 45.45% | 0.00% | +45.45% |
| F1分数 | 25.97% | 0.00% | +25.97% |

## 分析与结论

1. **总体性能**：GPT-4o在所有主要指标上都优于Gemini-1.5-flash，尤其是在事件级别准确率和召回率方面，GPT-4o领先超过20个百分点。

2. **鬼探头检测**：在鬼探头检测任务上，两个模型表现相同，但总体表现较差。这可能表明鬼探头行为的视觉特征更为复杂，对于大模型来说更加难以准确识别。

3. **加塞检测**：在加塞检测任务上，GPT-4o明显优于Gemini-1.5-flash。GPT-4o能够识别约45%的加塞事件，而Gemini-1.5-flash完全无法识别加塞行为。

4. **假阳性问题**：GPT-4o产生了更多的假阳性结果，特别是在加塞检测方面。这表明GPT-4o在尝试识别更多事件的同时，也增加了误报率。

5. **精确度与召回率权衡**：GPT-4o倾向于更高的召回率但牺牲了一定的精确度，而Gemini-1.5-flash则更为保守，减少了误报但同时也错过了许多真实事件。

## 改进建议

1. **提高鬼探头检测能力**：两个模型在鬼探头检测上的表现都较差，需要进一步优化提示词，更清晰地说明鬼探头的视觉特征和行为定义。

2. **减少GPT-4o的假阳性**：GPT-4o虽然召回率更高，但假阳性数量较多，需要优化模型以提高精确度。

3. **改进Gemini的加塞检测**：Gemini-1.5-flash完全无法识别加塞行为，需要针对性地改进该模型的加塞检测能力。

4. **时间戳匹配优化**：考虑优化时间戳匹配算法，当前使用±2秒的容差范围，可以根据视频特性进行调整。

5. **更大规模的数据测试**：扩大测试数据集，以获得更具统计意义的结果。

## 总结

在交通场景中危险行为检测任务上，GPT-4o总体表现优于Gemini-1.5-flash，尤其在加塞行为检测方面具有明显优势。然而，两个模型在鬼探头检测方面都有待提高。这些结果表明，虽然大型视觉语言模型在交通场景分析方面具有潜力，但仍需针对特定任务进行进一步的优化和改进。 