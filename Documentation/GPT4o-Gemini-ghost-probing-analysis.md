# GPT-4o与Gemini-1.5-flash鬼探头检测性能分析报告

## 摘要

本报告对GPT-4o和Gemini-1.5-flash两个大型视觉语言模型在交通场景中的鬼探头(Ghost Probing)和加塞(Cut-in)行为检测任务上进行了全面评估和比较。测试数据集包含DADA-2000数据集中的80个视频（images_10_001到images_10_080），通过对比模型预测结果与人工标注的ground truth，我们分析了两个模型的性能差异、错误模式以及潜在的改进方向。

## 实验设置

- **数据集**：DADA-2000数据集中的80个视频（images_10_001到images_10_080）
- **评估指标**：视频级别准确率、事件级别准确率、精确度、召回率、F1分数
- **任务**：检测交通场景中的鬼探头行为和加塞行为
- **模型**：GPT-4o和Gemini-1.5-flash

## 总体性能对比

| 指标 | GPT-4o | Gemini-1.5-flash | 差异(GPT-4o - Gemini) |
|------|--------|-------------------|----------------------|
| 视频级别准确率 | 58.75% | 52.50% | +6.25% |
| 事件级别准确率 | 29.55% | 6.82% | +22.73% |
| 精确度 | 16.05% | 9.38% | +6.67% |
| 召回率 | 29.55% | 6.82% | +22.73% |
| F1分数 | 20.80% | 7.89% | +12.91% |

## 按事件类型的性能

### 鬼探头(Ghost Probing)

| 指标 | GPT-4o | Gemini-1.5-flash | 差异 |
|------|--------|-------------------|------|
| 精确度 | 11.54% | 11.54% | 0% |
| 召回率 | 13.64% | 13.64% | 0% |
| F1分数 | 12.50% | 12.50% | 0% |

### 加塞(Cut-in)

| 指标 | GPT-4o | Gemini-1.5-flash | 差异 |
|------|--------|-------------------|------|
| 精确度 | 18.18% | 0.00% | +18.18% |
| 召回率 | 45.45% | 0.00% | +45.45% |
| F1分数 | 25.97% | 0.00% | +25.97% |

## 详细分析

### 事件分布情况

- **Ground Truth**：鬼探头事件22个，加塞事件22个
- **GPT-4o预测**：鬼探头事件26个，加塞事件55个
- **Gemini-1.5-flash预测**：鬼探头事件26个，加塞事件6个

### 错误类型分布

| 错误类型 | GPT-4o | Gemini-1.5-flash |
|---------|--------|------------------|
| 假阳性 | 25 | 10 |
| 假阴性 | 8 | 28 |

### 视频级别准确率

| 视频类型 | GPT-4o 准确率 | Gemini-1.5-flash 准确率 |
|---------|--------------|------------------------|
| 有事件视频 | 81.40% (35/43) | 34.88% (15/43) |
| 无事件视频 | 32.43% (12/37) | 72.97% (27/37) |

## 主要发现

1. **总体性能**：GPT-4o在整体性能上明显优于Gemini-1.5-flash，尤其是在事件级别准确率和召回率方面，领先超过20个百分点。

2. **鬼探头检测**：两个模型在鬼探头检测任务上表现相当，但总体表现较差。这可能是因为鬼探头行为的视觉特征复杂，难以被模型准确识别。

3. **加塞检测**：GPT-4o在加塞检测任务上明显优于Gemini-1.5-flash。GPT-4o能够识别约45%的加塞事件，而Gemini-1.5-flash几乎完全无法识别加塞行为。

4. **错误模式差异**：
   - **GPT-4o**：倾向于过度预测事件（假阳性率高），尤其是加塞事件
   - **Gemini-1.5-flash**：倾向于漏检事件（假阴性率高），尤其是加塞事件

5. **视频类型表现**：
   - **GPT-4o**：在有事件的视频上表现更好（81.40%），在无事件视频上准确率较低（32.43%）
   - **Gemini-1.5-flash**：在无事件视频上表现更好（72.97%），在有事件视频上准确率较低（34.88%）

## 典型错误案例分析

### GPT-4o常见错误

1. **假阳性案例**：在无事件视频中频繁错误地检测出加塞事件，例如在images_10_005视频中预测了多达3个不存在的事件。

2. **假阴性案例**：对一些鬼探头事件的检测不敏感，例如未能识别images_10_001、images_10_012等视频中明显的鬼探头行为。

### Gemini-1.5-flash常见错误

1. **假阳性案例**：主要集中在错误检测鬼探头行为上，例如在images_10_008等视频中。

2. **假阴性案例**：大量漏检各类事件，尤其是加塞事件，几乎无法识别任何加塞行为。

## 改进建议

### GPT-4o改进方向

1. **降低假阳性率**：调整模型提示，强调事件检测的精确度而非单纯追求高召回率，特别是对加塞事件的检测。

2. **鬼探头识别优化**：提供更明确的鬼探头视觉特征描述，增加示例图像，帮助模型更准确识别鬼探头行为。

3. **时间戳匹配优化**：改进时间戳识别算法，或增加时间容差范围，以提高事件匹配率。

### Gemini-1.5-flash改进方向

1. **提高召回率**：优化模型提示，鼓励模型更积极识别潜在事件，减少漏检率。

2. **加强加塞事件识别**：针对加塞事件进行专门的提示优化或训练，解决当前完全无法识别加塞行为的问题。

3. **平衡精确度和召回率**：虽然Gemini在无事件视频上表现较好，但需要在保持较低假阳性率的前提下提高召回率。

### 通用改进建议

1. **明确事件定义**：在系统提示中提供更清晰的鬼探头和加塞事件定义，强调它们的视觉差异特征。

2. **增加测试样本**：扩大测试数据集规模，以获得更具统计意义的结果。

3. **优化评估方法**：考虑引入更精细的评估指标，例如考虑时间戳匹配精度或事件持续时间的影响。

4. **组合模型优势**：考虑结合两个模型的优势，GPT-4o擅长检测事件（高召回率），而Gemini-1.5-flash在避免假阳性方面表现更好。

## 结论

GPT-4o和Gemini-1.5-flash在交通场景危险行为检测任务上各有优缺点。GPT-4o整体表现优于Gemini-1.5-flash，尤其在加塞行为检测方面具有明显优势，但两个模型在鬼探头检测方面都有较大改进空间。通过优化模型提示、明确事件定义和平衡精确度与召回率，可以进一步提升这些大型视觉语言模型在交通安全分析任务中的性能。

## 后续工作

1. **提示词优化**：基于错误分析结果，针对性地优化两个模型的提示词，特别是加强鬼探头的视觉特征描述。

2. **更大规模测试**：扩展到更多DADA-2000数据集视频，获得更全面的性能评估。

3. **模型集成**：探索GPT-4o和Gemini-1.5-flash的集成方案，结合两者优势提高整体性能。

4. **动态阈值调整**：研究基于场景复杂度的动态阈值调整方法，提高模型在不同场景下的适应性。 